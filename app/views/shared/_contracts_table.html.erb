<table border="1" cellspacing="0" cellpadding="2">

  <tr>
    <th>開始月</th><th>期間１</th><th>金額１</th><th>期間２</th><th>金額２</th><th>契約日</th><th>更・新</th><th>担当者</th>
  </tr>

<% @leaf.contracts.each do |c| %>
  <% unless c.start_month.blank? %>
  <tr>
    <td><%= c.start_month.strftime('%Y/%m') %></td>
    <td><%= c.term1 %></td>
    <td><%= c.money1 %></td>
    <td><%= c.term2 %></td>
    <td><%= c.money2 %></td>
    <td><%= c.contract_date.strftime('%m/%d') %></td>
    <td><% if c.new_flag then %>新規<% else %>更新<% end %></td>
    <td><%= c.staff_nickname %></td>
    
    <% c.seals.each do |s| %>
      <% if s.sealed_flag then %>
      <td><%= s.month.strftime('%m月') %>貼済 <%= s.sealed_date.strftime('%m/%d') %> <%= s.staff_nickname %></td>
      <% else %>
        <%= form_for([@leaf,c,s]) do |f| %>
          <%= f.hidden_field :sealed_flag, :value => true %>
          <%= f.hidden_field :sealed_date, :value => Date.today %>
          <%= f.hidden_field :staff_nickname, :value => session[:nickname] %>
    <td>
      <div class="actions">
          <%= f.submit(["#{s.month.strftime('%m月')}分シール貼付"]) %>
      </div>
    </td>
        <% end %>
        <% break %>
      <% end %>
    <% end %>
  <% end %>
  </tr>
<% end %>
</table>
<br/>
<%= link_to (button_tag '契約の変更・削除', type: 'button'), leaf_contracts_path(@leaf.to_param), method: :get %>
<br/>
