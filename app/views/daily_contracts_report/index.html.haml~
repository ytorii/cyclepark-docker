%header#header
  #inner
    %h1 日毎契約一覧

#contents.clearfix
  = render 'shared/side_menu'
  %main#main
    #daily_contracts
      = search_form_for(@query, url: daily_contracts_report_path, method: :post) do |f|
        = f.label :daily_contracts_scope, '契約日'
        = f.date_field :daily_contracts_scope
        = f.submit
      %hr
      #daily_contracts_total
        合計  #{@contracts_total[0][0]}件 #{number_to_currency(@contracts_total[0][1], unit: '\\', format: '%u%n')}
        %br
        １号地  #{@contracts_total[1][0]}件 #{number_to_currency(@contracts_total[1][1], unit: '\\', format: '%u%n')},
        バイク  #{@contracts_total[2][0]}件 #{number_to_currency(@contracts_total[2][1], unit: '\\', format: '%u%n')},
        ２号地  #{@contracts_total[3][0]}件 #{number_to_currency(@contracts_total[3][1], unit: '\\', format: '%u%n')}
      
      %br
      #daily_contracts_list
        %table.table.table-bordered.table-striped
          %thead
            %tr.success
              %th 契約種別
              %th 車種
              %th 契約番号
              %th 氏名
              %th 契約月
              %th 金額
              %th 担当者
          %tbody
            - @contracts_lists.each do |list|
              -if list
                %tr
                  %td 
                    - if list[:new_flag]
                      .new_contract_list
                        新規
                    - else
                      更新
                  %td 
                    - case list[:vhiecle_type]
                    - when 1
                      自転車
                    - when 2 
                      - unless list[:largebike_flag] == 't'
                        バイク
                      - else
                        大型バイク
                    - when 3
                      ２号地
                  %td= list[:number] 
                  %td= list[:first_name] + ' ' + list[:last_name]
                  %td= list.seals.map{|seal| seal.month.strftime('%-m')}.join(', ')
                  %td
                    =number_to_currency(list[:money1], unit: '\\', format: '%u%n')
                    - if list[:money2] > 0 
                      =number_to_currency(list[:money2], unit: '\\', format: '%u%n')
                  %td= list[:staff_nickname]
%footer#footer
  #inner
